Added new features and performance improvements and security handling